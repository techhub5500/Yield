<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alocação - Golden Hour UI</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #12100E;
            --glass-surface: rgba(40, 35, 30, 0.4);
            --glass-border: rgba(255, 230, 200, 0.08);
            --primary-gold: #D4AF37;
            --terracotta: #D97757;
            --positive: #8BA888;
            --text-main: #EAE5E0;
            --text-muted: #9A908A;
        }
        body {
            background-color: var(--bg-deep);
            background-image: radial-gradient(circle at 50% 0%, #3d2e26 0%, var(--bg-deep) 70%);
            font-family: 'Manrope', sans-serif;
            color: var(--text-main);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
        }
        .widget-card {
            width: 100%; max-width: 640px; background: var(--glass-surface);
            backdrop-filter: blur(16px); border: 1px solid var(--glass-border);
            border-radius: 20px; padding: 24px; box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        .header { display: flex; justify-content: space-between; margin-bottom: 24px; }
        h2 { font-family: 'Playfair Display', serif; margin: 0; font-size: 1.2rem; }
        .subtitle { font-size: 0.75rem; color: var(--text-muted); }
        .filters { display: flex; gap: 8px; margin-top: 8px;}
        .filter-btn {
            background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border);
            color: var(--text-muted); padding: 4px 10px; border-radius: 8px;
            font-size: 0.65rem; cursor: pointer; transition: 0.3s;
        }
        .filter-btn.active { background: rgba(255,255,255,0.1); color: var(--primary-gold); }
        
        /* KPIs */
        .kpi-grid { display: flex; gap: 20px; margin-bottom: 20px; border-bottom: 1px solid var(--glass-border); padding-bottom: 20px; }
        .kpi-item { flex: 1; }
        .kpi-label { font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; }
        .kpi-value { font-size: 1.4rem; font-weight: 300; line-height: 1.2; }
        
        /* Lista/Gráfico Barras */
        .allocation-list { display: flex; flex-direction: column; gap: 16px; }
        .alloc-row { cursor: pointer; padding: 8px; border-radius: 8px; transition: background 0.2s; }
        .alloc-row:hover { background: rgba(255,255,255,0.03); }
        
        .row-header { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.85rem; }
        .row-meta { font-size: 0.75rem; color: var(--text-muted); display: flex; gap: 10px; }
        
        /* Barras */
        .bar-container { position: relative; height: 8px; background: rgba(255,255,255,0.05); border-radius: 4px; overflow: hidden; margin-top: 6px; }
        .bar-target-marker { 
            position: absolute; top: 0; bottom: 0; width: 2px; background: rgba(255,255,255,0.5); z-index: 2; 
        }
        .bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; }
        
        /* Cores de Status */
        .on-track { background: var(--primary-gold); }
        .over { background: var(--terracotta); }
        .under { background: var(--positive); } /* Verde indica oportunidade de aporte */

        .diff-tag { font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; background: rgba(0,0,0,0.3); }
        
        #backNav { display: none; cursor: pointer; color: var(--primary-gold); font-size: 1.4rem; margin-bottom: 4px; }
    </style>
</head>
<body>
    <div class="widget-card">
        <div class="header">
            <div>
                <div id="backNav">←</div>
                <h2 id="cardTitle">Alocação Real vs. Planejada</h2>
                <div class="subtitle">Saúde estratégica da carteira</div>
            </div>
            <div class="filters">
                <button class="filter-btn active">Classe</button>
                <button class="filter-btn">Subclasse</button>
                <button class="filter-btn">Moeda</button>
            </div>
        </div>

        <div class="kpi-grid">
            <div class="kpi-item">
                <div class="kpi-label">Aderência (Score)</div>
                <div class="kpi-value" style="color: var(--primary-gold);">88/100</div>
            </div>
            <div class="kpi-item">
                <div class="kpi-label">Necessário para Rebalancear</div>
                <div class="kpi-value">R$ 14.200</div>
                <div class="subtitle" style="color: var(--positive);">Aporte Recomendado</div>
            </div>
        </div>

        <div class="allocation-list" id="allocList">
            </div>
    </div>

    <script>
        const dataStore = {
            'root': [
                { id: 'rv', name: 'Renda Variável', real: 32, target: 30, val: 'R$ 320k', diff: '+2%', status: 'over' },
                { id: 'rf', name: 'Renda Fixa', real: 45, target: 50, val: 'R$ 450k', diff: '-5%', status: 'under' },
                { id: 'ext', name: 'Invest. Exterior', real: 18, target: 15, val: 'R$ 180k', diff: '+3%', status: 'over' },
                { id: 'cx', name: 'Caixa / Oportunidade', real: 5, target: 5, val: 'R$ 50k', diff: '0%', status: 'on-track' }
            ],
            'rv': [
                { id: 'br-equity-alloc', name: 'Ações Brasil', real: 18, target: 15, val: 'R$ 180k', diff: '+3%', status: 'over' },
                { id: 'fiis-alloc', name: 'FIIs', real: 14, target: 15, val: 'R$ 140k', diff: '-1%', status: 'under' }
            ],
            'rf': [
                { name: 'Tesouro Direto', real: 25, target: 20, val: 'R$ 250k', diff: '+5%', status: 'over' },
                { name: 'CDB / LC', real: 20, target: 30, val: 'R$ 200k', diff: '-10%', status: 'under' }
            ],
            'ext': [
                { name: 'Stocks (EUA)', real: 12, target: 10, val: 'R$ 120k', diff: '+2%', status: 'over' },
                { name: 'REITs', real: 6, target: 5, val: 'R$ 60k', diff: '+1%', status: 'over' }
            ],
            'cx': [
                { name: 'Tesouro Selic', real: 3, target: 3, val: 'R$ 30k', diff: '0%', status: 'on-track' },
                { name: 'Conta Corrente', real: 2, target: 2, val: 'R$ 20k', diff: '0%', status: 'on-track' }
            ],
            'br-equity-alloc': [
                { name: 'VALE3', real: 6, target: 5, val: 'R$ 60k', diff: '+1%', status: 'over' },
                { name: 'PETR4', real: 7, target: 5, val: 'R$ 70k', diff: '+2%', status: 'over' },
                { name: 'ITUB4', real: 5, target: 5, val: 'R$ 50k', diff: '0%', status: 'on-track' }
            ],
            'fiis-alloc': [
                { name: 'HGLG11', real: 5, target: 5, val: 'R$ 50k', diff: '0%', status: 'on-track' },
                { name: 'XPML11', real: 4, target: 5, val: 'R$ 40k', diff: '-1%', status: 'under' },
                { name: 'KNIP11', real: 5, target: 5, val: 'R$ 50k', diff: '0%', status: 'on-track' }
            ]
        };

        const container = document.getElementById('allocList');
        const backBtn = document.getElementById('backNav');

        function render(viewKey) {
            const data = dataStore[viewKey] || dataStore['root'];
            
            if (viewKey !== 'root') backBtn.style.display = 'block';
            else backBtn.style.display = 'none';

            container.innerHTML = data.map(item => {
                // Cálculo visual da barra (escala baseada em 60% para caber)
                const width = (item.real / 60) * 100; 
                const targetPos = (item.target / 60) * 100;
                
                let actionText = '';
                if(item.status === 'over') actionText = 'Vender / Aguardar';
                if(item.status === 'under') actionText = 'Aportar';
                if(item.status === 'on-track') actionText = 'Manter';

                return `
                <div class="alloc-row" onclick="${item.id ? `render('${item.id}')` : ''}">
                    <div class="row-header">
                        <span>${item.name}</span>
                        <span>${item.val}</span>
                    </div>
                    <div class="bar-container">
                        <div class="bar-fill ${item.status}" style="width: ${width}%"></div>
                        <div class="bar-target-marker" style="left: ${targetPos}%" title="Meta: ${item.target}%"></div>
                    </div>
                    <div class="row-header" style="margin-top: 6px;">
                        <div class="row-meta">
                            <span>Real: ${item.real}%</span>
                            <span style="opacity: 0.5">Meta: ${item.target}%</span>
                        </div>
                        <div class="row-meta">
                            <span class="diff-tag" style="color: var(--${item.status === 'under' ? 'positive' : 'terracotta'})">${actionText} (${item.diff})</span>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        backBtn.addEventListener('click', () => render('root'));
        render('root');
    </script>
</body>
</html>