<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rentabilidade - Golden Hour UI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,600;1,600&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Paleta Crepuscular & Rocha */
            --bg-deep: #12100E;
            --bg-ambient: #2A211D;
            --glass-surface: rgba(40, 35, 30, 0.4);
            --glass-border: rgba(255, 230, 200, 0.08);
            --glass-shine: rgba(255, 255, 255, 0.03);
            
            /* Cores de Acento */
            --primary-gold: #D4AF37;
            --primary-glow: rgba(212, 175, 55, 0.2);
            --terracotta: #D97757;
            --positive: #8BA888;
            --negative: #D97757; /* Usando terracotta para negativo */
            --text-main: #EAE5E0;
            --text-muted: #9A908A;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-deep);
            background-image: radial-gradient(circle at 50% 0%, #3d2e26 0%, var(--bg-deep) 70%);
            font-family: 'Manrope', sans-serif;
            color: var(--text-main);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .widget-card {
            width: 100%;
            max-width: 640px; 
            background: var(--glass-surface);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.4),
                inset 0 1px 0 var(--glass-shine);
            padding: 24px;
            position: relative;
            overflow: visible;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        h2 {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            font-size: 1.2rem;
            letter-spacing: 0.02em;
            color: var(--text-main);
            margin-bottom: 2px;
        }

        .subtitle {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 400;
        }

        /* Filtros */
        .filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-group {
            background: rgba(0,0,0,0.2);
            padding: 2px;
            border-radius: 10px;
            display: flex;
            border: 1px solid var(--glass-border);
        }

        .filter-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 4px 10px;
            font-size: 0.65rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Manrope', sans-serif;
            font-weight: 600;
        }

        .filter-btn.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--primary-gold);
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        /* KPIs */
        .kpi-section {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        .kpi-box {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .main-value {
            font-size: 1.85rem;
            font-weight: 300;
            color: var(--text-main);
            line-height: 1;
        }

        .sub-value {
            font-size: 1rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Variação (Alfa) */
        .variation {
            display: inline-flex;
            align-items: center;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 6px;
            padding: 3px 8px;
            border-radius: 6px;
            background: rgba(139, 168, 136, 0.1);
            color: var(--positive);
            width: fit-content;
        }
        
        .variation.negative {
            background: rgba(217, 119, 87, 0.1);
            color: var(--negative);
        }

        /* Gráfico */
        .chart-container {
            width: 100%;
            height: 140px;
            position: relative;
            margin-bottom: 30px;
            cursor: crosshair;
        }

        svg {
            width: 100%;
            height: 100%;
            overflow: visible;
        }

        .chart-area {
            fill: url(#gradientGolden);
            opacity: 0.3;
        }

        .chart-line {
            fill: none;
            stroke: var(--primary-gold);
            stroke-width: 2;
            stroke-linecap: round;
            filter: drop-shadow(0 0 6px var(--primary-glow));
        }

        /* Linha de Benchmark */
        .benchmark-line {
            fill: none;
            stroke: rgba(255, 255, 255, 0.3);
            stroke-width: 1.5;
            stroke-dasharray: 4, 4;
            stroke-linecap: round;
        }

        .interactive-line {
            stroke: rgba(255, 255, 255, 0.2);
            stroke-width: 1;
            stroke-dasharray: 4;
            display: none;
        }

        .chart-dot {
            fill: var(--primary-gold);
            stroke: var(--bg-deep);
            stroke-width: 2;
            display: none;
        }

        /* Tooltip */
        .chart-tooltip {
            position: absolute;
            background: rgba(25, 20, 18, 0.95);
            border: 1px solid var(--glass-border);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            pointer-events: none;
            display: none;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            transform: translate(-50%, -100%);
            margin-top: -10px;
            white-space: nowrap;
        }

        /* Lista de Detalhes */
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            border-top: 1px solid var(--glass-border);
            padding-top: 20px;
        }

        .asset-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.03);
            font-weight: 400;
            cursor: pointer;
            transition: background 0.2s;
        }

        .asset-row:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .asset-info {
            display: flex;
            flex-direction: column;
        }

        .asset-name {
            font-weight: 400;
            font-size: 0.85rem;
        }

        .asset-meta {
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        .asset-value {
            text-align: right;
            font-weight: 400;
            font-size: 0.9rem;
            font-feature-settings: "tnum";
        }

        #backNav {
            display: none;
            cursor: pointer;
            color: var(--primary-gold);
            margin-bottom: 4px;
            font-size: 1.4rem;
            align-items: center;
            font-weight: 300;
            width: fit-content;
            transition: transform 0.2s ease;
        }

        #backNav:hover {
            transform: translateX(-4px);
        }

        /* Animations */
        .fade-exit { opacity: 0; transform: translateY(10px); transition: opacity 0.2s, transform 0.2s; }
        .fade-enter { opacity: 0; transform: translateY(-10px); }
        .fade-active { opacity: 1; transform: translateY(0); transition: opacity 0.3s, transform 0.3s; }

        @media (max-width: 600px) {
            .kpi-section { grid-template-columns: 1fr; }
            .details-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="widget-card">
        <div class="header">
            <div>
                <div id="backNav">←</div>
                <h2 id="cardTitle">Rentabilidade Consolidada</h2>
                <div class="subtitle" id="cardSubtitle">Performance ponderada pelo tempo</div>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <button class="filter-btn">MTD</button>
                    <button class="filter-btn">YTD</button>
                    <button class="filter-btn active">12M</button>
                    <button class="filter-btn">Origem</button>
                </div>
                <div class="filter-group">
                    <button class="filter-btn active">R$</button>
                    <button class="filter-btn">US$</button>
                </div>
            </div>
        </div>

        <div class="kpi-section">
            <div class="kpi-box">
                <span class="label" id="mainLabel">Retorno do Período</span>
                <div class="main-value" id="mainValue">18,45%</div>
                <div class="variation" id="mainVariation">
                    Alfa: +3,20 p.p.
                </div>
            </div>
            <div class="kpi-box" style="border-left: 1px solid var(--glass-border); padding-left: 20px;">
                <span class="label" id="secondaryLabel">Benchmark (CDI)</span>
                <div class="sub-value" style="font-size: 1.3rem; color: var(--text-main);" id="secondaryValue">15,25%</div>
                <div class="subtitle" style="margin-top: 4px; font-size: 0.65rem;">Meta superada</div>
            </div>
        </div>

        <div class="chart-container" id="chartContainer">
            <div class="chart-tooltip" id="chartTooltip"></div>
            <svg viewBox="0 0 800 200" preserveAspectRatio="none" id="chartSvg">
                <defs>
                    <linearGradient id="gradientGolden" x1="0" x2="0" y1="0" y2="1">
                        <stop offset="0%" stop-color="#D4AF37" stop-opacity="0.3"/>
                        <stop offset="100%" stop-color="#D4AF37" stop-opacity="0"/>
                    </linearGradient>
                </defs>
                
                <path class="chart-area" d="M0,180 C150,170 300,100 450,80 S650,40 800,20 V200 H0 Z" />
                
                <path class="benchmark-line" d="M0,180 C150,175 300,140 450,120 S650,90 800,80" />
                
                <path class="chart-line" d="M0,180 C150,170 300,100 450,80 S650,40 800,20" />
                
                <line x1="0" y1="0" x2="0" y2="200" class="interactive-line" id="vLine" />
                <circle cx="0" cy="0" r="4" class="chart-dot" id="chartDot" />
            </svg>
        </div>

        <div class="details-grid" id="detailsGrid">
            <div id="colLeft">
                <span class="label" style="color: var(--primary-gold);">Maiores Contribuições</span>
                <div class="asset-row" data-view="acoes-br">
                    <div class="asset-info">
                        <span class="asset-name">Renda Variável</span>
                        <span class="asset-meta">Retorno: 22,40%</span>
                    </div>
                    <div class="asset-value">
                        <div>+12,5%</div>
                        <div style="font-size: 0.7rem; color: var(--text-muted);">Contribuição</div>
                    </div>
                </div>
            </div>

            <div id="colRight">
                <span class="label" style="color: var(--terracotta);">Estabilidade</span>
                <div class="asset-row" data-view="rf">
                    <div class="asset-info">
                        <span class="asset-name">Renda Fixa</span>
                        <span class="asset-meta">Retorno: 13,10%</span>
                    </div>
                    <div class="asset-value">
                        <div>+5,9%</div>
                        <div style="font-size: 0.7rem; color: var(--text-muted);">Contribuição</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Store de Dados: Rentabilidade
        const viewStates = {
            'total': {
                title: 'Rentabilidade Consolidada',
                subtitle: 'Performance ponderada pelo tempo',
                label: 'Retorno do Período',
                value: '18,45%',
                variation: 'Alfa: +3,20 p.p.',
                secondaryLabel: 'Benchmark (CDI)',
                secondaryValue: '15,25%',
                details: {
                    left: [
                        { id: 'acoes-br', name: 'Renda Variável', value: '+12,5%', meta: 'Retorno: 22,40%', varText: 'Contribuição' }
                    ],
                    right: [
                        { id: 'rf', name: 'Renda Fixa', value: '+5,9%', meta: 'Retorno: 13,10%', varText: 'Contribuição' }
                    ]
                }
            },
            // NÍVEL 2: Renda Variável
            'acoes-br': {
                title: 'Renda Variável',
                subtitle: 'Rentabilidade vs Ibovespa',
                label: 'Retorno da Classe',
                value: '22,40%',
                variation: 'Alfa: +8,40 p.p.',
                secondaryLabel: 'Benchmark (IBOV)',
                secondaryValue: '14,00%',
                details: {
                    left: [
                        { id: 'stocks', name: 'Stocks (EUA)', value: '+8,1%', meta: 'Retorno: 25,0%', varText: 'Contrib.' },
                        { id: 'fiis', name: 'FIIs', value: '+2,0%', meta: 'Retorno: 10,5%', varText: 'Contrib.' }
                    ],
                    right: [
                        { id: 'br-equity', name: 'Ações Brasil', value: '+2,4%', meta: 'Retorno: 18,2%', varText: 'Contrib.' }
                    ]
                }
            },
            // NÍVEL 2: Renda Fixa
            'rf': {
                title: 'Renda Fixa',
                subtitle: 'Rentabilidade vs CDI',
                label: 'Retorno da Classe',
                value: '13,10%',
                variation: 'Alfa: -0,10 p.p.',
                secondaryLabel: 'Benchmark (CDI)',
                secondaryValue: '13,20%',
                details: {
                    left: [
                        { id: 'ipca', name: 'Tesouro IPCA+', value: '+3,1%', meta: 'Retorno: 14,5%', varText: 'Contrib.' }
                    ],
                    right: [
                        { id: 'cdi', name: 'Crédito Privado', value: '+2,8%', meta: 'Retorno: 12,5%', varText: 'Contrib.' }
                    ]
                }
            },
            // NÍVEL 3: Ativos (Exemplos)
            'stocks': {
                title: 'Stocks (EUA)',
                subtitle: 'Exposição em Dólar',
                label: 'Rentabilidade',
                value: '25,00%',
                variation: 'Alfa: +5,0 p.p.',
                secondaryLabel: 'S&P 500 (BRL)',
                secondaryValue: '20,00%',
                details: {
                    left: [
                        { id: 'nvda', name: 'NVDA', value: '+65,0%', meta: 'Contrib: 1,5%', varText: '' }
                    ],
                    right: [
                        { id: 'msft', name: 'MSFT', value: '+12,0%', meta: 'Contrib: 0,8%', varText: '' }
                    ]
                }
            },
            'fiis': {
                title: 'FIIs',
                subtitle: 'Carteira de Fundos Imobiliários',
                label: 'Rentabilidade',
                value: '10,50%',
                variation: 'Alfa: +1,2 p.p.',
                secondaryLabel: 'IFIX',
                secondaryValue: '9,30%',
                details: {
                    left: [
                        { id: 'hglg11', name: 'HGLG11', value: '+12,4%', meta: 'Contrib: 0,5%', varText: '' },
                        { id: 'knip11', name: 'KNIP11', value: '+9,8%', meta: 'Contrib: 0,4%', varText: '' }
                    ],
                    right: [
                        { id: 'xpml11', name: 'XPML11', value: '+15,2%', meta: 'Contrib: 0,6%', varText: '' }
                    ]
                }
            },
            'br-equity': {
                title: 'Ações Brasil',
                subtitle: 'Performance vs Ibovespa',
                label: 'Rentabilidade',
                value: '18,20%',
                variation: 'Alfa: +4,2 p.p.',
                secondaryLabel: 'Benchmark (IBOV)',
                secondaryValue: '14,00%',
                details: {
                    left: [
                        { id: 'vale3', name: 'VALE3', value: '+15,0%', meta: 'Contrib: 1,2%', varText: '' },
                        { id: 'petr4', name: 'PETR4', value: '+22,5%', meta: 'Contrib: 1,8%', varText: '' }
                    ],
                    right: [
                        { id: 'itub4', name: 'ITUB4', value: '+12,0%', meta: 'Contrib: 0,9%', varText: '' }
                    ]
                }
            },
            // NÍVEL 4: Detalhe do Ativo (Exemplos)
            'hglg11': {
                title: 'HGLG11',
                subtitle: 'CGHG Logística FII',
                label: 'Retorno Total',
                value: '12,40%',
                variation: 'Dividend Yield: 9,2%',
                secondaryLabel: 'Preço Médio',
                secondaryValue: 'R$ 162,40',
                details: {
                    left: [
                        { name: 'Rendimento Mensal', value: 'R$ 1,10', meta: 'Data-com: 30/01', varText: 'Por cota' },
                        { name: 'Variação Cota', value: '+3,2%', meta: 'No período', varText: '' }
                    ],
                    right: [
                        { name: 'Patrimonial', value: 'R$ 158,00', meta: 'P/VP: 1,03', varText: '' }
                    ]
                }
            },
            'knip11': {
                title: 'KNIP11',
                subtitle: 'Kinea Índice de Preços',
                label: 'Retorno Total',
                value: '9,80%',
                variation: 'Dividend Yield: 10,5%',
                secondaryLabel: 'Preço Médio',
                secondaryValue: 'R$ 95,20',
                details: {
                    left: [{ name: 'Rendimento', value: 'R$ 0,95', meta: 'IPCA + 7%', varText: '' }],
                    right: [{ name: 'P/VP', value: '1.00', meta: 'Par de mercado', varText: '' }]
                }
            },
            'xpml11': {
                title: 'XPML11',
                subtitle: 'XP Malls FII',
                label: 'Retorno Total',
                value: '15,20%',
                variation: 'Dividend Yield: 8,1%',
                secondaryLabel: 'Preço Médio',
                secondaryValue: 'R$ 112,00',
                details: {
                    left: [{ name: 'Rendimento', value: 'R$ 0,85', meta: 'Shoppings', varText: '' }],
                    right: [{ name: 'Variação Cota', value: '+7,1%', meta: 'Recuperação', varText: '' }]
                }
            },
            'vale3': {
                title: 'VALE3',
                subtitle: 'Vale S.A.',
                label: 'Retorno Total',
                value: '15,00%',
                variation: 'Alfa: +1,0 p.p.',
                secondaryLabel: 'Preço Atual',
                secondaryValue: 'R$ 68,50',
                details: {
                    left: [
                        { name: 'Dividendos', value: 'R$ 2,40', meta: 'DY: 4,5%', varText: 'Recebido' }
                    ],
                    right: [
                        { name: 'Volatilidade', value: '28%', meta: 'Beta: 1.1', varText: '' }
                    ]
                }
            },
            'petr4': {
                title: 'PETR4',
                subtitle: 'Petrobras PN',
                label: 'Retorno Total',
                value: '22,50%',
                variation: 'Dividend Yield: 18%',
                secondaryLabel: 'Preço Médio',
                secondaryValue: 'R$ 34,20',
                details: {
                    left: [{ name: 'Variação Cota', value: '+12%', meta: 'Ano', varText: '' }],
                    right: [{ name: 'Petróleo Bruto', value: 'US$ 82', meta: 'Brent', varText: '' }]
                }
            },
            'itub4': {
                title: 'ITUB4',
                subtitle: 'Itaú Unibanco PN',
                label: 'Retorno Total',
                value: '12,00%',
                variation: 'ROE: 21%',
                secondaryLabel: 'P/L',
                secondaryValue: '8.4',
                details: {
                    left: [{ name: 'Dividendos', value: 'R$ 0,45', meta: 'Trimestral', varText: '' }],
                    right: [{ name: 'Eficiência', value: '39%', meta: 'Operacional', varText: '' }]
                }
            },
            'nvda': {
                title: 'NVDA',
                subtitle: 'NVIDIA Corporation',
                label: 'Retorno Total',
                value: '65,00%',
                variation: 'Alfa: +45 p.p.',
                secondaryLabel: 'Market Cap',
                secondaryValue: '2.5T',
                details: {
                    left: [{ name: 'Crescimento', value: '+260%', meta: 'Receita DataCenter', varText: '' }],
                    right: [{ name: 'Margem Bruta', value: '76%', meta: 'Liderança IA', varText: '' }]
                }
            },
            'msft': {
                title: 'MSFT',
                subtitle: 'Microsoft Corp',
                label: 'Retorno Total',
                value: '12,00%',
                variation: 'Azure: +30%',
                secondaryLabel: 'Preço Atual',
                secondaryValue: 'US$ 415',
                details: {
                    left: [{ name: 'Cloud', value: 'US$ 33B', meta: 'Receita Q', varText: '' }],
                    right: [{ name: 'AI/OpenAI', value: 'Parceria', meta: 'Estratégico', varText: '' }]
                }
            }
        };

        const originalDetailsGrid = document.getElementById('detailsGrid').innerHTML;
        const navigationHistory = ['total'];

        // Elementos
        const backNav = document.getElementById('backNav');
        const cardTitle = document.getElementById('cardTitle');
        const cardSubtitle = document.getElementById('cardSubtitle');
        const mainLabel = document.getElementById('mainLabel');
        const mainValue = document.getElementById('mainValue');
        const mainVariation = document.getElementById('mainVariation');
        const secondaryLabel = document.getElementById('secondaryLabel');
        const secondaryValue = document.getElementById('secondaryValue');
        const detailsGrid = document.getElementById('detailsGrid');
        const widgetCard = document.querySelector('.widget-card');

        function generateColumnHtml(items, title) {
            let html = `<div><span class="label" style="opacity: 0.7;">${title}</span>`;
            items.forEach(item => {
                html += `
                    <div class="asset-row" data-view="${item.id || ''}">
                        <div class="asset-info">
                            <span class="asset-name">${item.name}</span>
                            <span class="asset-meta">${item.meta}</span>
                        </div>
                        <div class="asset-value">
                            <div>${item.value}</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted);">${item.varText || ''}</div>
                        </div>
                    </div>`;
            });
            html += `</div>`;
            return html;
        }

        async function updateView(viewKey, isBack = false) {
            const state = viewStates[viewKey];
            if (!state) return;

            widgetCard.classList.add('fade-exit');
            await new Promise(r => setTimeout(r, 200));

            if (!isBack && viewKey !== 'total') {
                navigationHistory.push(viewKey);
            }

            cardTitle.innerText = state.title;
            cardSubtitle.innerText = state.subtitle;
            mainLabel.innerText = state.label;
            mainValue.innerText = state.value;
            mainVariation.innerText = state.variation;
            secondaryLabel.innerText = state.secondaryLabel;
            secondaryValue.innerText = state.secondaryValue;

            // Lógica de cor do Alfa
            if(state.variation.includes('-')) {
                mainVariation.classList.add('negative');
            } else {
                mainVariation.classList.remove('negative');
            }

            if (viewKey === 'total') {
                backNav.style.display = 'none';
                detailsGrid.innerHTML = originalDetailsGrid;
            } else {
                backNav.style.display = 'flex';
                let html = '';
                if (state.details.left) html += generateColumnHtml(state.details.left, 'Classes / Ativos');
                if (state.details.right) html += generateColumnHtml(state.details.right, 'Composição');
                detailsGrid.innerHTML = html;
            }

            attachRowListeners();

            widgetCard.classList.remove('fade-exit');
            widgetCard.classList.add('fade-enter');
            void widgetCard.offsetWidth;
            widgetCard.classList.add('fade-active');
            
            setTimeout(() => {
                widgetCard.classList.remove('fade-enter', 'fade-active');
            }, 300);
        }

        function attachRowListeners() {
            document.querySelectorAll('.asset-row').forEach(row => {
                row.addEventListener('click', () => {
                    const view = row.getAttribute('data-view');
                    if (view && viewStates[view]) updateView(view);
                });
            });
        }

        backNav.addEventListener('click', () => {
            if (navigationHistory.length > 1) {
                navigationHistory.pop();
                const previous = navigationHistory[navigationHistory.length - 1];
                updateView(previous, true);
            }
        });

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const siblings = this.parentElement.querySelectorAll('.filter-btn');
                siblings.forEach(s => s.classList.remove('active'));
                this.classList.add('active');
            });
        });

        attachRowListeners();

        // Lógica do Gráfico Interativo
        const container = document.getElementById('chartContainer');
        const svg = document.getElementById('chartSvg');
        const vLine = document.getElementById('vLine');
        const dot = document.getElementById('chartDot');
        const tooltip = document.getElementById('chartTooltip');
        const linePath = svg.querySelector('.chart-line');
        const pathLength = linePath.getTotalLength();

        container.addEventListener('mousemove', (e) => {
            const rect = svg.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const svgX = (x / rect.width) * 800;
            if (svgX < 0 || svgX > 800) return;

            let low = 0, high = pathLength;
            let targetX = svgX;
            let pt = linePath.getPointAtLength(0);

            for (let i = 0; i < 8; i++) {
                const mid = (low + high) / 2;
                pt = linePath.getPointAtLength(mid);
                if (pt.x < targetX) low = mid;
                else high = mid;
            }

            vLine.setAttribute('x1', pt.x); vLine.setAttribute('x2', pt.x);
            vLine.style.display = 'block';
            dot.setAttribute('cx', pt.x); dot.setAttribute('cy', pt.y);
            dot.style.display = 'block';

            // Simulação de valores para o tooltip
            const pct = ((200 - pt.y) / 200) * 20; // Aproximação de 0 a 20%
            const bench = pct - 3.2; 
            
            tooltip.style.display = 'block';
            tooltip.style.left = `${x}px`;
            tooltip.style.top = `${(pt.y / 200) * rect.height}px`;
            tooltip.innerHTML = `
                <div style="font-weight: 700; color: var(--primary-gold);">Portfólio: ${pct.toFixed(2)}%</div>
                <div style="font-size: 0.7rem; color: var(--text-muted);">Benchmark: ${bench.toFixed(2)}%</div>
            `;
        });

        container.addEventListener('mouseleave', () => {
            vLine.style.display = 'none';
            dot.style.display = 'none';
            tooltip.style.display = 'none';
        });
    </script>
</body>
</html>